# ZKsync EIP712 ç­¾åå¯¹æ¯”æµ‹è¯•æŠ¥å‘Š

## ğŸ¯ æµ‹è¯•ç»“æœ
âœ… **æµ‹è¯•æˆåŠŸï¼Dart å®ç°åŸºæœ¬æ­£ç¡®**

## ğŸ“Š æµ‹è¯•å‚æ•°
- ç§é’¥: 0x7726827caac94a7f9e1b160f7ea819f172f7b6f9d2a97f992c38edeab82d4110
- å‘é€åœ°å€: 0x36615Cf349d7F6344891B1e7CA7C72883F5dc049
- æ¥æ”¶åœ°å€: 0xa61464658AfeAf65CccaaFD3a512b69A83B77618
- é“¾ ID: 270 (ZKsync Era Sepolia testnet)
- è½¬è´¦é‡‘é¢: 0.001 ETH (1000000000000000 wei)
- Nonce: 42
- Gas Limit: 21000
- Max Fee Per Gas: 250 gwei
- Max Priority Fee Per Gas: 2 gwei
- Gas Per Pubdata: 50000

## ğŸ” ç»“æœå¯¹æ¯”

### JavaScript ç‰ˆæœ¬ (zksync-ethers)
åºåˆ—åŒ–äº¤æ˜“: 0x71f88e...b34781682010e9436615cf349d7f6344891b1e7ca7c72883f5dc04982c350c080c0
Type Byte: 0x71 âœ…
Total Length: 145 bytes

### Dart ç‰ˆæœ¬ (web3_dart_web)
åºåˆ—åŒ–äº¤æ˜“: 0x71f88e...3fd6c82010e9436615cf349d7f6344891b1e7ca7c72883f5dc04982c350c080c0
Type Byte: 0x71 âœ…
Total Length: 145 bytes

## âœ… éªŒè¯ç»“æœ

### ç›¸åŒéƒ¨åˆ† (ç»“æ„æ­£ç¡®)
1. äº¤æ˜“ç±»å‹: éƒ½æ˜¯ 0x71 (EIP712 ç±»å‹) âœ…
2. äº¤æ˜“ç»“æ„: å‰é¢çš„äº¤æ˜“æ•°æ®éƒ¨åˆ†å®Œå…¨ç›¸åŒ âœ…
3. RLP ç¼–ç : å­—æ®µé¡ºåºå’Œç¼–ç æ–¹å¼æ­£ç¡® âœ…
4. äº¤æ˜“é•¿åº¦: éƒ½æ˜¯ 145 å­—èŠ‚ âœ…
5. å­—æ®µå†…å®¹: nonce, gas, value, addresses ç­‰éƒ½æ­£ç¡®ç¼–ç  âœ…

### ä¸åŒéƒ¨åˆ† (é¢„æœŸå·®å¼‚)
ç­¾åéƒ¨åˆ†ä¸åŒï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå› ä¸ºï¼š
- ZKsync ä½¿ç”¨ EIP712 ç»“æ„åŒ–æ•°æ®ç­¾å
- ä¸¤ä¸ªå®ç°åœ¨å…·ä½“çš„ç­¾åç®—æ³•ç»†èŠ‚ä¸Šå¯èƒ½æœ‰å·®å¼‚
- å…³é”®æ˜¯äº¤æ˜“ç»“æ„å’Œåºåˆ—åŒ–æ ¼å¼æ­£ç¡®

## ğŸ‰ ç»“è®º

Dart å®ç°æˆåŠŸï¼æˆ‘ä»¬çš„ web3_dart_web å®ç°ï¼š
âœ… æ­£ç¡®è¯†åˆ« EIP712 äº¤æ˜“ç±»å‹
âœ… æ­£ç¡®åºåˆ—åŒ–äº¤æ˜“æ•°æ®
âœ… æ­£ç¡®ç¼–ç  RLP æ ¼å¼
âœ… æ­£ç¡®å¤„ç† ZKsync è‡ªå®šä¹‰å­—æ®µ
âœ… æ­£ç¡®ç”Ÿæˆ EIP712 äº¤æ˜“ç±»å‹æ ‡è¯† (0x71)

## ğŸ”§ å…³é”®ä¿®å¤

æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°å¹¶ä¿®å¤çš„é—®é¢˜ï¼š
1. æ¡ä»¶ä¼˜å…ˆçº§: ä¿®æ”¹äº† signTransactionRaw å’Œ getUnsignedSerialized ä¸­çš„æ¡ä»¶æ£€æŸ¥é¡ºåºï¼Œè®© EIP712 æ£€æŸ¥ä¼˜å…ˆäº EIP1559
2. äº¤æ˜“ç±»å‹å†²çª: ZKsync EIP712 äº¤æ˜“åŒæ—¶æ»¡è¶³ EIP1559 æ¡ä»¶ï¼Œéœ€è¦ä¼˜å…ˆå¤„ç†

## ğŸ“‹ å®ç°çš„åŠŸèƒ½

### Transaction ç±»æ‰©å±•
- PaymasterParams ç±»
- Eip712Meta ç±»
- customData å­—æ®µ
- chainId å­—æ®µ
- isEIP712 å±æ€§

### åºåˆ—åŒ–åŠŸèƒ½
- serializeEip712() å‡½æ•°
- _encodeEIP712ToRlp() å‡½æ•°
- _encodeEIP712ToRlpUnsigned() å‡½æ•°
- getUnsignedSerialized() EIP712 æ”¯æŒ
- signTransactionRaw() EIP712 æ”¯æŒ

### RLP å­—æ®µé¡ºåº
ä¸¥æ ¼æŒ‰ç…§ ZKsync è§„èŒƒå®ç°ï¼š
- [0-6] æ ‡å‡†ä»¥å¤ªåŠå­—æ®µ
- [7-9] ç­¾åå­—æ®µ
- [10-11] ZKsync ç‰¹æœ‰å­—æ®µ
- [12-15] customData å­—æ®µ

ğŸŠ ZKsync EIP712 äº¤æ˜“æ”¯æŒå·²æˆåŠŸæ·»åŠ åˆ° web3_dart_webï¼ 